<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>Harizal - IT Consultant & Cyber Security Analyst</title>
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
  <style>
    /* Reset & base */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #121212;
      color: #eee;
      scroll-behavior: smooth;
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
    }
    /* particles.js container (untuk bagian bawah) */
    #particles-js {
      position: fixed; top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: -1;
      background: radial-gradient(circle at center, #1e1e1e, #121212);
    }
    a { color: #1e90ff; text-decoration: none; transition: color 0.3s ease; word-break: break-word; }
    a:hover, a:focus { text-decoration: underline; outline: none; color: #63b3ed; }
    section { padding: 80px 20px; max-width: 900px; margin: 0 auto; position: relative; z-index: 2; }
    h1, h2, h3 { margin-bottom: 0.5em; font-weight: 700; line-height: 1.1; }
    h1 { font-size: clamp(2.5rem, 5vw, 4rem); }
    h2 { font-size: clamp(1.5rem, 3vw, 2rem); border-bottom: 2px solid #1e90ff; padding-bottom: 0.3em; margin-bottom: 1em; }
    p { font-size: clamp(1rem, 2vw, 1.1rem); margin-bottom: 1em; color: #ddd; word-wrap: break-word; }
    ul { list-style: none; padding-left: 0; margin-bottom: 1em; }
    li { margin-bottom: 0.5em; line-height: 1.4; }
    
    /* Hero Section (untuk Confetti Cannon) */
    #hero {
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 0 20px;
      position: relative;
      z-index: 1;
      overflow: hidden; /* Penting untuk menampung elemen animasi */
    }
    .pricing-hero__proxy { position: absolute; inset: 0; }
    .pricing-hero__canvas { position: absolute; inset: 0; z-index: 3; }
    .pricing-hero__hand { position: absolute; top: 0; left: 0; z-index: 4; pointer-events: none; opacity: 0; }
    .pricing-hero__hand small {
        position: absolute; top: -20px; left: 50%;
        transform: translateX(-50%);
        color: #fff;
        background: #111;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
    }
    .slingshot {
      position: absolute; bottom: 20px; left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 120px;
      pointer-events: none;
      z-index: 2;
    }
    
    #hero-content { max-width: 600px; z-index: 5; } /* Konten harus di atas animasi */
    #hero h1 { color: #1e90ff; text-shadow: 0 0 10px #1e90ff; margin-bottom: 0.3em; }
    #hero h3 { font-weight: 400; font-size: clamp(1rem, 2vw, 1.5rem); margin-bottom: 1.5em; color: #ccc; }
    #hero button {
      background-color: #1e90ff; border: none; padding: 15px 30px;
      font-size: 1.1rem; color: white; border-radius: 30px;
      cursor: pointer; transition: background-color 0.3s ease, transform 0.2s ease; user-select: none;
    }
    #hero button:hover, #hero button:focus { background-color: #0f5bb5; transform: translateY(-2px); outline: none; }
    
    /* Sisanya sama seperti kode Blackbox AI */
    .section-content { background-color: rgba(30, 30, 30, 0.9); border-radius: 10px; padding: 30px; box-shadow: 0 0 20px rgba(30, 144, 255, 0.2); border: 1px solid rgba(255, 255, 255, 0.1); }
    .item { margin-bottom: 1.5em; padding-bottom: 1.5em; border-bottom: 1px solid #333; }
    .item:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
    .item-title { font-weight: 700; font-size: 1.2rem; color: #1e90ff; word-break: break-word; }
    .item-subtitle { font-style: italic; color: #aaa; margin-bottom: 0.3em; word-break: break-word; }
    .project-category { margin-bottom: 1.5em; }
    .project-category h4 { color: #1e90ff; margin-bottom: 0.5em; }
    #popup-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); z-index: 1000; display: none; justify-content: center; align-items: center; padding: 20px; }
    #popup-form-container { background-color: #1e1e1e; padding: 30px; border-radius: 10px; width: 100%; max-width: 500px; box-shadow: 0 5px 25px rgba(0,0,0,0.5); position: relative; color: #eee; }
    #popup-form-container h2 { border-bottom: none; text-align: center; margin-bottom: 1em; font-size: 1.5rem; }
    #popup-form label { display: block; margin-bottom: 5px; color: #ccc; font-weight: 600; }
    #popup-form input, #popup-form textarea { width: 100%; padding: 10px; margin-bottom: 15px; border-radius: 5px; border: 1px solid #444; background-color: #2a2a2a; color: #eee; font-size: 1rem; font-family: inherit; transition: border-color 0.3s ease; }
    #popup-form input:focus, #popup-form textarea:focus { border-color: #1e90ff; outline: none; }
    #popup-form textarea { resize: vertical; min-height: 100px; }
    #popup-form button { width: 100%; padding: 12px; border-radius: 5px; background-color: #1e90ff; color: white; border: none; cursor: pointer; font-size: 1rem; font-weight: 700; user-select: none; transition: background-color 0.3s ease; }
    #popup-form button:hover, #popup-form button:focus { background-color: #0f5bb5; outline: none; }
    #close-popup { position: absolute; top: 15px; right: 15px; font-size: 1.5rem; color: #aaa; cursor: pointer; border: none; background: none; user-select: none; transition: color 0.3s ease; }
    #close-popup:hover, #close-popup:focus { color: #fff; outline: none; }
    #popup-message { text-align: center; margin-top: 10px; font-weight: 700; min-height: 1.5em; word-wrap: break-word; }
  </style>
</head>
<body>
  
  <div id="particles-js" aria-hidden="true"></div>

  <header id="hero" role="banner" aria-label="Hero section with name and title">
    <svg class="pricing-hero__canvas"></svg>
    <div class="pricing-hero__proxy"></div>
    <div class="pricing-hero__hand">
        <small>Drag and release to launch!</small>
    </div>
    <img src="https://assets.codepen.io/16327/slingshot.svg" class="slingshot" />
    <img class="pricing-hero__rock" src="https://assets.codepen.io/16327/rock.svg" />
    <img class="pricing-hero__drag" src="https://assets.codepen.io/16327/drag.svg" />
    <img class="pricing-hero__handle" src="https://assets.codepen.io/16327/handle.svg" />
    
    <div class="image-preload" style="display: none;">
        <img data-key="js" src="https://assets.codepen.io/16327/js.svg" />
        <img data-key="react" src="https://assets.codepen.io/16327/react.svg" />
        <img data-key="node" src="https://assets.codepen.io/16327/node.svg" />
    </div>
    <div class="explosion-preload" style="display: none;">
        <img data-key="js" src="https://assets.codepen.io/16327/js-small.svg" />
        <img data-key="react" src="https://assets.codepen.io/16327/react-small.svg" />
        <img data-key="node" src="https://assets.codepen.io/16327/node-small.svg" />
    </div>
    
    <div id="hero-content" data-aos="fade-up" data-aos-duration="1500">
      <h1 id="name">Harizal</h1>
      <h3 id="title">IT Consultant | Cyber Security Analyst</h3>
      <button id="contact-btn" aria-haspopup="dialog" aria-controls="popup-overlay" aria-expanded="false">Hubungi Kami</button>
    </div>
  </header>

  <main>
    <section id="about" data-aos="fade-up" data-aos-duration="1000" tabindex="-1">
      <h2>About Me</h2>
      <div class="section-content" id="about-content" aria-live="polite"></div>
    </section>
    
    <section id="work-experience" data-aos="fade-up" data-aos-duration="1000" tabindex="-1">
        <h2>Work Experience</h2>
        <div class="section-content" id="work-experience-content" aria-live="polite"></div>
    </section>
    <section id="projects" data-aos="fade-up" data-aos-duration="1000" tabindex="-1">
        <h2>Projects</h2>
        <div class="section-content" id="projects-content" aria-live="polite"></div>
    </section>
    <section id="education" data-aos="fade-up" data-aos-duration="1000" tabindex="-1">
        <h2>Education</h2>
        <div class="section-content" id="education-content" aria-live="polite"></div>
    </section>
    <section id="certifications" data-aos="fade-up" data-aos-duration="1000" tabindex="-1">
        <h2>Certifications & Training</h2>
        <div class="section-content" id="certifications-content">
            <h3>Certifications</h3>
            <ul id="certifications-list" aria-live="polite"></ul>
            <h3>Trainings</h3>
            <ul id="trainings-list" aria-live="polite"></ul>
        </div>
    </section>
    <section id="contact" data-aos="fade-up" data-aos-duration="1000" tabindex="-1">
        <h2>Contact</h2>
        <div class="section-content">
            <p>Email: <a href="mailto:harizalbanget@gmail.com" id="email-link" rel="nofollow noopener noreferrer"></a></p>
            <p>
                <a href="#" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn">LinkedIn</a> |
                <a href="#" target="_blank" rel="noopener noreferrer" aria-label="GitHub">GitHub</a>
            </p>
        </div>
    </section>
  </main>
  
  <div id="popup-overlay" role="dialog" aria-modal="true" aria-labelledby="popup-title" tabindex="-1">
    <div id="popup-form-container">
        <button id="close-popup" aria-label="Close contact form">&times;</button>
        <h2 id="popup-title">Minta Curriculum Vitae</h2>
        <form id="popup-form" novalidate>
            <label for="popup-name">Nama Anda:</label>
            <input type="text" id="popup-name" name="name" required autocomplete="name" aria-required="true" />
            <label for="popup-email">Email Anda:</label>
            <input type="email" id="popup-email" name="email" required autocomplete="email" aria-required="true" />
            <label for="popup-company">Perusahaan/Institusi:</label>
            <input type="text" id="popup-company" name="company" autocomplete="organization" />
            <label for="popup-message-text">Pesan:</label>
            <textarea id="popup-message-text" name="message" required aria-required="true"></textarea>
            <button type="submit">Kirim Permintaan</button>
        </form>
        <div id="popup-message" role="alert" aria-live="assertive"></div>
    </div>
  </div>

  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
  <script src="https://unpkg.co/gsap@3/dist/gsap.min.js"></script>
  <script src="https://unpkg.com/gsap@3/dist/ScrollTrigger.min.js"></script>
  <script src="https://unpkg.com/gsap@3/dist/Observer.min.js"></script>
  <script src="https://unpkg.com/gsap@3/dist/CustomEase.min.js"></script>
  <script src="https://unpkg.com/gsap@3/dist/CustomWiggle.min.js"></script>
  <script src="https://unpkg.com/gsap@3/dist/Physics2DPlugin.min.js"></script>

  <script>
    AOS.init({ once: true });

    // --- INISIALISASI PARTICLES.JS (untuk bagian bawah) ---
    // Logika ini akan dijalankan saat user scroll melewati hero
    let particlesInitialized = false;
    function initParticles() {
        if (particlesInitialized) return;
        particlesInitialized = true;
        particlesJS('particles-js', {
            particles: {
                number: { value: 60, density: { enable: true, value_area: 700 } },
                color: { value: "#1e90ff" },
                shape: { type: "circle" },
                opacity: { value: 0.4, random: false },
                size: { value: 3, random: true },
                line_linked: { enable: true, distance: 140, color: "#1e90ff", opacity: 0.3, width: 1 },
                move: { enable: true, speed: 3, direction: "none", random: false, straight: false, out_mode: "out", bounce: false }
            },
            interactivity: {
                detect_on: "canvas",
                events: { onhover: { enable: true, mode: "repulse" }, onclick: { enable: true, mode: "push" }, resize: true },
                modes: { repulse: { distance: 120, duration: 0.4 }, push: { particles_nb: 4 } }
            },
            retina_detect: true
        });
    }

    // Panggil initParticles saat user mulai scroll
    window.addEventListener('scroll', initParticles, { once: true });

    // --- LOGIKA CONFETTI CANNON (untuk hero section) ---
    gsap.registerPlugin(Observer, CustomEase, CustomWiggle, Physics2DPlugin, ScrollTrigger);
    class confettiCannon {
      constructor(el) { this.el = el; }
      init() {
        const hero = this.el; this.hero = hero;
        const el = {
          hand: hero.querySelector(".pricing-hero__hand"),
          instructions: hero.querySelector(".pricing-hero__hand small"),
          rock: hero.querySelector(".pricing-hero__rock"),
          drag: hero.querySelector(".pricing-hero__drag"),
          handle: hero.querySelector(".pricing-hero__handle"),
          canvas: hero.querySelector(".pricing-hero__canvas"),
          proxy: hero.querySelector(".pricing-hero__proxy"),
          preloadImages: hero.querySelectorAll(".image-preload img"),
          xplodePreloadImages: hero.querySelectorAll(".explosion-preload img")
        };
        this.el = el; this.isDrawing = false; this.imageMap = {}; this.imageKeys = [];
        this.el.preloadImages.forEach((img) => { const key = img.dataset.key; this.imageMap[key] = img; this.imageKeys.push(key); });
        this.explosionMap = {}; this.explosionKeys = [];
        this.el.xplodePreloadImages.forEach((img) => { const key = img.dataset.key; this.explosionMap[key] = img; this.explosionKeys.push(key); });
        this.currentLine = null; this.startImage = null; this.circle = null; this.startX = 0; this.startY = 0; this.lastDistance = 0;
        this.animationIsOk = window.matchMedia("(prefers-reduced-motion: no-preference)").matches;
        this.wiggle = CustomWiggle.create("myWiggle", { wiggles: 6 });
        this.clamper = gsap.utils.clamp(1, 100);
        this.xSetter = gsap.quickTo(this.el.hand, "x", { duration: 0.1 });
        this.ySetter = gsap.quickTo(this.el.hand, "y", { duration: 0.1 });
        this.setpricingMotion(); this.initObserver(); this.initEvents();
      }
      initEvents() {
        if (!this.animationIsOk || ScrollTrigger.isTouch === 1) return;
        this.hero.style.cursor = "none";
        this.hero.addEventListener("mouseenter", (e) => { gsap.set(this.el.hand, { opacity: 1 }); this.xSetter(e.x, e.x); this.ySetter(e.y, e.y); });
        this.hero.addEventListener("mouseleave", (e) => { gsap.set(this.el.hand, { opacity: 0 }); });
        this.hero.addEventListener("mousemove", (e) => { this.xSetter(e.x); this.ySetter(e.y); });
        gsap.delayedCall(1, (e) => { this.createExplosion(window.innerWidth/2, window.innerHeight/2, 600); });
      }
      setpricingMotion() { gsap.set(this.el.hand, { xPercent: -50, yPercent: -50 }); }
      initObserver() {
        if (!this.animationIsOk) return;
        if (ScrollTrigger.isTouch === 1) {
          Observer.create({ target: this.el.proxy, type: "touch", onPress: (e) => { this.createExplosion(e.x, e.y, 400); } });
        } else {
          Observer.create({ target: this.el.proxy, type: "pointer", onPress: (e) => this.startDrawing(e), onDrag: (e) => this.isDrawing && this.updateDrawing(e), onDragEnd: (e) => this.clearDrawing(e), onRelease: (e) => this.clearDrawing(e) });
        }
      }
      startDrawing(e) {
        this.isDrawing = true; gsap.set(this.el.instructions, { opacity: 0 }); this.startX = e.x; this.startY = e.y + window.scrollY;
        this.currentLine = document.createElementNS("http://www.w3.org/2000/svg", "line");
        this.currentLine.setAttribute("x1", this.startX); this.currentLine.setAttribute("y1", this.startY); this.currentLine.setAttribute("x2", this.startX); this.currentLine.setAttribute("y2", this.startY); this.currentLine.setAttribute("stroke", "#fffce1"); this.currentLine.setAttribute("stroke-width", "2"); this.currentLine.setAttribute("stroke-dasharray", "4");
        this.circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        this.circle.setAttribute("cx", this.startX); this.circle.setAttribute("cy", this.startY); this.circle.setAttribute("r", "30"); this.circle.setAttribute("fill", "#0e100f");
        const randomKey = gsap.utils.random(this.imageKeys); const original = this.imageMap[randomKey]; const clone = document.createElementNS("http://www.w3.org/2000/svg", "image");
        clone.setAttribute("x", this.startX - 25); clone.setAttribute("y", this.startY - 25); clone.setAttribute("width", "50"); clone.setAttribute("height", "50"); clone.setAttributeNS("http://www.w3.org/1999/xlink", "href", original.src);
        this.startImage = clone; this.el.canvas.appendChild(this.currentLine); this.el.canvas.appendChild(this.circle); this.el.canvas.appendChild(this.startImage);
        gsap.set(this.el.drag, { opacity: 1 }); gsap.set(this.el.handle, { opacity: 1 }); gsap.set(this.el.rock, { opacity: 0 });
      }
      updateDrawing(e) {
        if (!this.currentLine || !this.startImage) return;
        let cursorX = e.x; let cursorY = e.y + window.scrollY; let dx = cursorX - this.startX; let dy = cursorY - this.startY;
        let distance = Math.sqrt(dx * dx + dy * dy); let shrink = (distance - 30) / distance; let x2 = this.startX + dx * shrink; let y2 = this.startY + dy * shrink;
        if (distance < 30) { x2 = this.startX; y2 = this.startY; }
        let angle = Math.atan2(dy, dx) * (180 / Math.PI);
        gsap.to(this.currentLine, { attr: { x2, y2 }, duration: 0.1, ease: "none" });
        let raw = distance / 100; let eased = Math.pow(raw, 0.5); let clamped = this.clamper(eased);
        gsap.set([this.startImage, this.circle], { scale: clamped, rotation: `${angle + -45}_short`, transformOrigin: "center center" });
        gsap.to(this.el.hand, { rotation: `${angle + -90}_short`, duration: 0.1, ease: "none" });
        this.lastDistance = distance;
      }
      createExplosion(x, y, distance = 100) {
        const count = Math.round(gsap.utils.clamp(3, 100, distance / 20)); const angleSpread = Math.PI * 2; const explosion = gsap.timeline();
        const speed = gsap.utils.mapRange(0, 500, 0.3, 1.5, distance); const sizeRange = gsap.utils.mapRange(0, 500, 20, 60, distance);
        for (let i = 0; i < count; i++) {
          const randomKey = gsap.utils.random(this.explosionKeys); const original = this.explosionMap[randomKey]; const img = original.cloneNode(true);
          img.className = "explosion-img"; img.style.position = "absolute"; img.style.pointerEvents = "none";
          img.style.height = `${gsap.utils.random(20, sizeRange)}px`; img.style.left = `${x}px`; img.style.top = `${y}px`; img.style.zIndex = 4;
          this.hero.appendChild(img);
          const angle = Math.random() * angleSpread; const velocity = gsap.utils.random(500, 1500) * speed;
          explosion.to(img, { physics2D: { angle: angle * (180 / Math.PI), velocity: velocity, gravity: 3000 }, rotation: gsap.utils.random(-180, 180), duration: 1 + Math.random() }, 0)
                   .to(img, { opacity: 0, duration: 0.2, ease: "power1.out", onComplete: () => img.remove() }, 1);
        }
        return explosion;
      }
      clearDrawing(e) {
        if (!this.isDrawing) return; this.createExplosion(this.startX, this.startY, this.lastDistance);
        gsap.set(this.el.drag, { opacity: 0 }); gsap.set(this.el.handle, { opacity: 0 }); gsap.set(this.el.rock, { opacity: 1 });
        gsap.to(this.el.rock, { duration: 0.4, rotation: "+=30", ease: "myWiggle", onComplete: () => {
          gsap.set(this.el.rock, { opacity: 0 }); gsap.set(this.el.hand, { rotation: 0, overwrite: "auto" });
          gsap.to(this.el.instructions, { opacity: 1 }); gsap.set(this.el.drag, { opacity: 1 });
        }});
        this.isDrawing = false; this.el.canvas.innerHTML = ""; this.currentLine = null; this.startImage = null;
      }
    }
    const cannon = new confettiCannon(document.getElementById('hero'));
    cannon.init();


    // --- LOAD DATA FROM SERVER ---
    async function loadData() {
        try {
            const res = await fetch('/get-data');
            if (!res.ok) throw new Error(`Server responded with status: ${res.status}`);
            const data = await res.json();
            const personalInfo = data.personalInfo || {};
            const workExperience = Array.isArray(data.workExperience) ? data.workExperience : [];
            const projects = data.projects || {};
            const education = Array.isArray(data.education) ? data.education : [];
            const certifications = Array.isArray(data.certifications) ? data.certifications : [];
            const trainings = Array.isArray(data.trainings) ? data.trainings : [];
            document.getElementById('name').textContent = personalInfo.name || 'Nama Tidak Tersedia';
            document.getElementById('title').textContent = personalInfo.title || 'Judul Tidak Tersedia';
            const emailLink = document.getElementById('email-link');
            emailLink.textContent = personalInfo.email || '';
            emailLink.href = personalInfo.email ? `mailto:${personalInfo.email}` : '#';
            const aboutContent = document.getElementById('about-content');
            aboutContent.innerHTML = `<p>Experienced IT professional...</p><p><strong>Address:</strong> ${personalInfo.address || 'Tidak Tersedia'}</p>`;
            const workContainer = document.getElementById('work-experience-content');
            workContainer.innerHTML = '';
            workExperience.forEach(exp => {
                const div = document.createElement('div');
                div.classList.add('item');
                div.innerHTML = `<div class="item-title">${exp.position || ''}</div><div class="item-subtitle">${exp.company || ''} | ${exp.period || ''}</div>`;
                workContainer.appendChild(div);
            });
            const projectsContainer = document.getElementById('projects-content');
            projectsContainer.innerHTML = '';
            const createProjectCategory = (title, items) => {
                if (!Array.isArray(items) || items.length === 0) return document.createDocumentFragment();
                const catDiv = document.createElement('div');
                catDiv.classList.add('project-category');
                const h4 = document.createElement('h4');
                h4.textContent = title;
                catDiv.appendChild(h4);
                const ul = document.createElement('ul');
                items.forEach(item => { const li = document.createElement('li'); li.textContent = item; ul.appendChild(li); });
                catDiv.appendChild(ul);
                return catDiv;
            };
            projectsContainer.appendChild(createProjectCategory('IT', projects.it));
            projectsContainer.appendChild(createProjectCategory('Networking & Infrastructure', projects.network_infrastructure));
            projectsContainer.appendChild(createProjectCategory('Security', projects.security));
            const educationContainer = document.getElementById('education-content');
            educationContainer.innerHTML = '';
            education.forEach(edu => {
                const div = document.createElement('div');
                div.classList.add('item');
                div.innerHTML = `<div class="item-title">${edu.degree || ''}</div><div class="item-subtitle">${edu.institution || ''} | ${edu.status || ''}</div>`;
                educationContainer.appendChild(div);
            });
            const certList = document.getElementById('certifications-list');
            certList.innerHTML = '';
            certifications.forEach(cert => { const li = document.createElement('li'); li.textContent = cert; certList.appendChild(li); });
            const trainingList = document.getElementById('trainings-list');
            trainingList.innerHTML = '';
            trainings.forEach(training => { const li = document.createElement('li'); li.textContent = training; trainingList.appendChild(li); });
        } catch (error) {
            console.error('Error loading data:', error);
            document.getElementById('about-content').innerHTML = '<p style="color: #ff4c4c;">Failed to load content. Please try again later.</p>';
        }
    }
    loadData();

    // --- CONTACT POPUP LOGIC ---
    const contactBtn = document.getElementById('contact-btn');
    const popupOverlay = document.getElementById('popup-overlay');
    const closePopupBtn = document.getElementById('close-popup');
    const popupForm = document.getElementById('popup-form');
    const popupMessage = document.getElementById('popup-message');
    contactBtn.addEventListener('click', () => { popupOverlay.style.display = 'flex'; document.getElementById('popup-name').focus(); });
    closePopupBtn.addEventListener('click', () => { popupOverlay.style.display = 'none'; });
    popupOverlay.addEventListener('click', (e) => { if (e.target === popupOverlay) { popupOverlay.style.display = 'none'; } });
    popupForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const submitButton = popupForm.querySelector('button');
        submitButton.disabled = true;
        popupMessage.textContent = 'Mengirim...';
        popupMessage.style.color = '#ccc';
        const formData = { name: document.getElementById('popup-name').value, email: document.getElementById('popup-email').value, company: document.getElementById('popup-company').value, message: document.getElementById('popup-message-text').value };
        try {
            const res = await fetch('/contact-request', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(formData) });
            const result = await res.json();
            if (!res.ok) throw new Error(result.message || 'Server error');
            popupMessage.textContent = 'Permintaan Anda telah terkirim. Terima kasih!';
            popupMessage.style.color = '#63ed7a';
            popupForm.reset();
            setTimeout(() => { popupOverlay.style.display = 'none'; popupMessage.textContent = ''; }, 3000);
        } catch (error) {
            popupMessage.textContent = 'Terjadi kesalahan. Silakan coba lagi.';
            popupMessage.style.color = '#ff4c4c';
        } finally {
            submitButton.disabled = false;
        }
    });
  </script>
</body>
</html>